
{% set groups = {
    ('global.unlock_weapon_twohands'|trans) : ['Greatsword', 'Hammer', 'Rifle', 'Staff', 'LongBow', 'ShortBow'],
    ('global.unlock_weapon_onehand'|trans) : ['Sword', 'Axe', 'Mace', 'Dagger', 'Scepter', 'Pistol', 'Focus', 'Warhorn', 'Shield', 'Torch'],
    ('global.unlock_weapon_aquatic'|trans) : ['Speargun', 'Harpoon', 'Trident'],
} %}
{% set wardrobe = account.wardrobe.weapons %}


{% for group, types in groups %}

    {{ _self.group(group, types, wardrobe, _context) }}

{% endfor %}


{% macro group(name, types, wardrobe, context) %}
    {% set count = 0 %}
    {% set total = 0 %}
    {% for type in types %}
        {% set data = wardrobe[type] %}
        {% set count = count + data.count %}
        {% set total = total + data.total %}
    {% endfor %}

    {% if total %}
        <div class="panel panel-inverse collapsed">
            <div class="panel-heading">
                <div class="pull-right expandcollapse">
                    <i class="glyphicon glyphicon-plus"></i>
                    <i class="glyphicon glyphicon-minus"></i>
                </div>
                <div class="pull-right" title="{{ (100 * count / total)|round }}%">
                    {{ count }} / {{ total }}
                </div>
                <b>{{ name }}</b>
            </div>
        </div>

        <div style="display: none">
            {% for type in types %}
                {% set data = wardrobe[type] %}
                {% if data.total %}
                    {% set map = context.account.client.getskinitems(data.skins|keys)%}
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <div class="pull-right" title="{{ (100 * data.count / data.total)|round }}">
                                {{ data.count }} / {{ data.total }}
                            </div>
                            {{ ('itemtype.'~type)|trans }}
                        </div>
                        <div class="panel-body slots">
                            {% for skin in data.skins %}
                                {% set item = map[skin.id] %}
                                <div class="slot {{ skin.unlocked ? '' : 'empty' }}">
                                    {% if skin.id %}
                                        <img src="{{ skin|image }}" {{ (item ? item : skin)|gwlink|raw }}/>
                                    {% else %}
                                        <img src="{{ ""|image }}" class="nothing" />
                                    {% endif %}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    {% endif %}
{% endmacro %}