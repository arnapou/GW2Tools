{% extends "base.twig" %}

{% block css %}
	{{ parent () }}
	<style>
		img.craft {
			height: 1.42857em;
		}
	</style>
	
{% endblock %}

{% block content %}

	{% set characters = apiclient.v2_characters(apiclient.v2_characters())|sort_array('created') %}

	<table class="table">
		<thead>
			<tr>
				<th>Name</th>
				<th>Level</th>
				<th>Gender</th>
				<th>Race</th>
				<th>Profession</th>
				<th>Guild</th>
				<th>Crafting</th>
				<th>Created</th>
				<th class="text-right">Days</th>
				<th class="text-right">Played</th>
				<th class="text-right">Deaths</th>
			</tr>
		</thead>
		<tbody>
			{% for char in characters %}
				<tr>
					<td><a href="{{ char.name }}"><b>{{ char.name }}</b></a></td>
					<td>{{ char.level }}</td>
					<td>{{ char.gender }}</td>
					<td>{{ char.race }}</td>
					<td>{{ char.profession }}</td>
					<td>{{ apiclient.guild_name(char.guild) }}</td>
					<td>
						{% for craft in char.crafting %}
						<span data-toggle="tooltip" title="{{ craft.discipline }}">
							{% if craft.active and craft.rating %}
								<img class="craft" src="{{ apiclient.craft_icon(craft.discipline) }}" />
								{{ craft.rating }}
							{% endif %}
						</span> 
						{% endfor %}
					</td>
					<td>{{ char.created|date('Y-m-d H:i:s')|slice(0,16) }}</td>
					<td class="text-right">{{ (('now'|date('U') - char.created|date('U')) / 86400)|round(0, 'floor') }}</td>
					<td class="text-right">{{ (char.age/3600)|round(0, 'floor') }}</td>
					<td class="text-right">{{ char.deaths }}</td>
				</tr>
				<script>console.log({{ char|json_encode|raw}})</script>
			{% endfor %}
		</tbody>
	</table>
{% endblock %}

{% block js %}
	{{ parent() }}

	<script>
		$(function () {

		});
	</script>
{% endblock %}